#!/usr/bin/env sh
# Path: /usr/bin/nnnopen
#
# Exit if file doesn't exist
[ -f "$1" ] || exit 0

file="$1"
mime=$(file -b --mime-type "$file")
echo "$mime"

case "$mime" in
    # ── Images ────────────────────────────────────────────────
    image/*)
        sxiv -ab "$file" &
        ;;

    # ── Video or Audio ────────────────────────────────────────
    video/*|audio/*)
        mpv --player-operation-mode=pseudo-gui -- "$file" &
        ;;

    # ── Text, JSON, and setup scripts ─────────────────────────
    text/*|application/json|application/x-setupscript)
        alacritty -e nvim "$file"
        ;;

    # ── eBooks (PDF, EPUB) ───────────────────────────────────
    application/pdf|application/epub+zip)
        zathura "$file" &
        ;;

    # ── Gzip archives (rnote) ────────────────────────────────
    application/gzip)
        rnote "$file" &
        ;;

    # ── LibreOffice documents ────────────────────────────────
    application/vnd.oasis.opendocument.text|\
    application/vnd.openxmlformats-officedocument.wordprocessingml.document|\
    application/vnd.openxmlformats-officedocument.presentationml.presentation)
        libreoffice "$file" &
        ;;

    # ── Default fallback ─────────────────────────────────────
    *)
        alacritty -e nvim "$file"
        ;;
esac

exit 0

